<script setup lang="ts">
definePageMeta({
  layout: 'game'
})

useSeoMeta({
  title: 'Ch∆°i C·∫°ch C·∫°ch Online | Game B√†i Party Ch∆°i C√πng B·∫°n B√®',
  description: 'Ch∆°i C·∫°ch C·∫°ch online ngay tr√™n tr√¨nh duy·ªát. Game b√†i ti·ªác t√πng t∆∞∆°ng t√°c cao, ch∆°i c√†ng ƒë√¥ng c√†ng vui, kh√¥ng c·∫ßn t·∫£i app.',
  ogTitle: 'Ch∆°i C·∫°ch C·∫°ch Online | Game B√†i Party Ch∆°i C√πng B·∫°n B√®',
  ogDescription: 'Ch∆°i C·∫°ch C·∫°ch online ngay tr√™n tr√¨nh duy·ªát. Game b√†i ti·ªác t√πng t∆∞∆°ng t√°c cao, ch∆°i c√†ng ƒë√¥ng c√†ng vui, kh√¥ng c·∫ßn t·∫£i app.',
  ogImage: '/og-image.jpg',
  ogType: 'website',
  ogUrl: 'https://cachcach.org/game',
  twitterCard: 'summary_large_image',
  twitterImage: '/og-image.jpg',
})



const sections = [
  {
    title: 'Top game hot',
    icon: 'üî•',
    games: [
      {
        title: 'Drinking card',
        subtitle: 'Th·ª≠ th√°ch t√°o b·∫°o c√πng b·∫°n b√®',
        link: '/game/drinking-card',
        icon: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-8 h-8"><path d="M14 3l7 7m-11 1L3 18l3 3 7-7M10 7l7 7" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
        color: 'bg-orange-500'
      },
      {
        title: 'Th·∫≠t hay th√°ch',
        subtitle: 'N√≥i th·∫≠t l√≤ng ho·∫∑c nh·∫≠n h√¨nh ph·∫°t',
        link: '/game/truth-or-dare',
        icon: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-8 h-8"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
        color: 'bg-purple-500'
      }
    ]
  },
  {
    title: 'D√†nh cho nh√≥m b·∫°n',
    icon: 'üë•',
    games: [
      {
        title: 'Drinking card',
        subtitle: 'Th·ª≠ th√°ch t√°o b·∫°o c√πng b·∫°n b√®',
        link: '/game/drinking-card',
        icon: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-8 h-8"><path d="M14 3l7 7m-11 1L3 18l3 3 7-7M10 7l7 7" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
        color: 'bg-orange-500'
      },
      {
        title: 'Ch·ªçn ly',
        subtitle: 'T√¨m ph·∫ßn th∆∞·ªüng trong ly ng·∫´u nhi√™n',
        link: '/game/choose-goblet',
        icon: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-8 h-8"><path d="M7 2h10l1 7-8 12-8-12 1-7zM7 2v7h10V2M7 13h10" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
        color: 'bg-blue-500'
      },
      {
        title: 'Unlucky box',
        subtitle: 'Th·ª≠ v·∫≠n may, tr√°nh h·ªôp r·ªóng',
        link: '/game/unlucky-box',
        icon: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-8 h-8"><path d="M21 8l-2-2H5L3 8v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8zM3 8h18M7.5 13h9M12 8v5" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
        color: 'bg-emerald-500'
      }
    ]
  }
]

const coupleSection = {
  title: 'D√†nh cho c·∫∑p ƒë√¥i',
  icon: '‚ù§Ô∏è',
  games: [
    {
      title: 'Drinking card 18+',
      subtitle: 'H√¢m n√≥ng t√¨nh c·∫£m v·ªõi nh·ªØng th·ª≠ th√°ch n√≥ng b·ªèng.',
      link: '/game/drinking-card/18-plus',
      color: 'from-[#f43f5e] to-[#fb7185]',
      shadow: 'shadow-rose-500/10'
    },
    {
      title: 'Th·∫≠t hay th√°ch 18+',
      subtitle: 'Nh·ªØng c√¢u h·ªèi v√† th·ª≠ th√°ch t√°o b·∫°o d√†nh cho ƒë√¥i l·ª©a.',
      link: '/game/truth-or-dare/18-plus',
      color: 'from-[#ef4444] to-[#b91c1c]',
      shadow: 'shadow-red-500/10'
    }
  ]
}

const carousel = useTemplateRef('carousel')
const coupleCarouselIndex = ref(0)

function onSelect(index: number) {
  coupleCarouselIndex.value = index
}

function select(index: number) {
  coupleCarouselIndex.value = index
  carousel.value?.emblaApi?.scrollTo(index)
}
</script>

<template>
  <div class="space-y-12 pb-10">
    <!-- Top game hot -->
    <section v-if="sections[0]" :key="sections[0].title" class="px-4">
      <div class="flex items-center gap-2 mb-6">
        <span class="text-xl">{{ sections[0].icon }}</span>
        <h2 class="text-xl font-bold text-white">{{ sections[0].title }}</h2>
      </div>

      <div class="overflow-x-auto -mx-4 px-4 pb-4 scrollbar-hide snap-x">
        <div class="flex gap-6 w-max">
          <div 
            v-for="(game, index) in sections[0].games" 
            :key="index" 
            class="w-[220px] bg-[#1a232e] rounded-[44px] p-5 flex flex-col items-center text-center snap-start"
          >
            <!-- Icon Circle -->
            <div 
              class="w-[88px] h-[88px] rounded-full flex items-center justify-center mb-5 shadow-lg shadow-black/20 text-white"
              :class="game.color"
              v-html="game.icon"
            ></div>

            <h3 class="text-lg font-bold text-white mb-2 leading-tight">{{ game.title }}</h3>
            <p class="text-gray-400 text-xs mb-6 line-clamp-2">{{ game.subtitle }}</p>

            <NuxtLink 
              :to="game.link" 
              class="mt-auto w-full py-2.5 px-4 bg-white/5 hover:bg-white/10 active:scale-95 transition-all text-white rounded-[20px] text-sm font-bold"
            >
              Ch∆°i ngay
            </NuxtLink>
          </div>
        </div>
      </div>
    </section>

    <!-- Couple Section (Carousel) -->
    <section class="pb-4">
      <div class="px-4 flex items-center gap-2 mb-6">
        <span class="text-xl">{{ coupleSection.icon }}</span>
        <h2 class="text-xl font-bold text-white">{{ coupleSection.title }}</h2>
      </div>

      <div class="relative w-full max-w-sm mx-auto">
        <UCarousel 
          ref="carousel"
          :items="coupleSection.games" 
          class="w-full"
          :ui="{ 
            container: 'rounded-[32px]',
            item: 'basis-full'
          }"
          @select="onSelect"
        >
          <template #default="{ item }">
            <div class="px-3 w-full">
              <div 
                class="relative w-full overflow-hidden rounded-[32px] bg-gradient-to-r p-8 shadow-xl active:scale-[0.98] transition-all group shrink-0"
                :class="[item.color, item.shadow]"
              >
                <NuxtLink :to="item.link" class="absolute inset-0 z-30"></NuxtLink>
                
                <div class="relative z-10 flex flex-col items-start gap-4">
                  <span class="px-2.5 py-1 bg-black/20 backdrop-blur-md rounded-full text-[10px] font-bold text-white border border-white/10">18+</span>
                  
                  <div class="max-w-[85%]">
                    <h3 class="text-xl font-black text-white mb-2">{{ item.title }}</h3>
                    <p class="text-white/80 text-xs leading-relaxed line-clamp-2">{{ item.subtitle }}</p>
                  </div>

                  <div class="mt-2 px-5 py-2 bg-white text-rose-500 rounded-full text-xs font-bold shadow-lg group-hover:scale-105 transition-transform">
                    Kh√°m ph√°
                  </div>
                </div>

                <!-- Background Decorative Icon -->
                <div class="absolute right-[-10px] bottom-[-10px] w-32 h-32 text-white/20 -rotate-12 pointer-events-none group-hover:scale-110 transition-transform duration-500">
                  <svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                </div>
              </div>
            </div>
          </template>
        </UCarousel>

        <!-- Custom Dot Navigation -->
        <div class="absolute bottom-6 left-1/2 -translate-x-1/2 flex justify-center gap-3 z-40">
          <button 
            v-for="(game, index) in coupleSection.games" 
            :key="index"
            @click="select(index)"
            class="w-2 h-2 rounded-full transition-all duration-300 border border-white/50"
            :class="[coupleCarouselIndex === index ? 'bg-white border-white scale-125 w-4' : 'bg-transparent hover:bg-white/20']"
            :aria-label="`Go to slide ${index + 1}`"
          />
        </div>
      </div>
    </section>

    <!-- Subsequent Regular Sections ("D√†nh cho nh√≥m b·∫°n", etc.) -->
    <section v-for="section in sections.slice(1)" :key="section.title" class="px-4">
      <div class="flex items-center gap-2 mb-6">
        <span class="text-xl">{{ section.icon }}</span>
        <h2 class="text-xl font-bold text-white">{{ section.title }}</h2>
      </div>

      <div class="overflow-x-auto -mx-4 px-4 pb-4 scrollbar-hide snap-x">
        <div class="flex gap-6 w-max">
          <div 
            v-for="(game, index) in section.games" 
            :key="index" 
            class="w-[220px] bg-[#1a232e] rounded-[44px] p-5 flex flex-col items-center text-center snap-start"
          >
            <!-- Icon Circle -->
            <div 
              class="w-[88px] h-[88px] rounded-full flex items-center justify-center mb-5 shadow-lg shadow-black/20 text-white"
              :class="game.color"
              v-html="game.icon"
            ></div>

            <h3 class="text-lg font-bold text-white mb-2 leading-tight">{{ game.title }}</h3>
            <p class="text-gray-400 text-xs mb-6 line-clamp-2">{{ game.subtitle }}</p>

            <NuxtLink 
              :to="game.link" 
              class="mt-auto w-full py-2.5 px-4 bg-white/5 hover:bg-white/10 active:scale-95 transition-all text-white rounded-[20px] text-sm font-bold"
            >
              Ch∆°i ngay
            </NuxtLink>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<style scoped>
/* Hide scrollbar for Chrome, Safari and Opera */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}
</style>
